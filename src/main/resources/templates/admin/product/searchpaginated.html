<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
		layout:decorate="~{admin/layout-admin.html}">
<head>
    <meta charset="UTF-8">
    <title>Product Manager</title>
</head>
<body>
	<div layout:fragment="content">
	    <!-- Check if the user is authenticated
	    <div sec:authorize="isAuthenticated()">
	        Welcome <b th:text="${#authentication.name}"></b>
	        &nbsp;
	        <i th:text="${#authentication.principal.authorities}"></i>
	    </div>--> 
	
	    <form th:action="@{/logout}" method="post">
	        <input type="submit" value="Logout">
	    </form>
	
	    <h1>Product Manager</h1>
	    <!-- <div sec:authorize="hasAnyAuthority('CREATOR', 'ADMIN')"> -->
	        <a href="/admin/products/add">Add Product</a>
	    <!-- </div> -->
	
	    <div th:if="${message != null}">
	        <i th:text="${message}"></i>
	    </div>
	
	    <form th:action="@{/admin/products/searchpaginated}">
	        <input type="text" id="name" name="name" placeholder="Nhập từ khóa để tìm" />
	        <button>Search</button>
	    </form>

    	<table>
           <thead>
               <tr>
                   <th>STT</th>
                   <th>Images</th>
                   <th>Product Name</th>
                   <th>Quantity</th>
                   <th>Note</th>
                   <th>Type</th>
                   <th>Price</th>
                   <th>Tag</th>
                   <th>Hide</th>
                   <!-- <div sec:authorize="hasAnyAuthority('EDITOR', 'ADMIN')"> -->
                       <th>Action</th>
                   <!-- </div> -->
               </tr>
           </thead>
           <tbody>
               <tr th:each="product, stt : ${list}">
                   <td th:text="${stt.index + 1}"></td>
                   <td>
                       <div th:if="${product.images != null}">
                           <img th:src="@{'/admin/products/images/' + ${product.images}}" alt="Image" width="100" height="100" />
                       </div>
                       <div th:if="${product.images == null}">
                           <img src="/static/images/noimage.jpg" alt="Image" width="100" height="100" />
                       </div>
                   </td>
                   <td th:text="${product.name}"></td>
                   <td th:text="${product.quantity}"></td>
                   <td th:text="${product.note}"></td>
                   <td th:text="${product.type}"></td>
                   <td th:text="${product.price}"></td>
                   <td th:text="${product.tag}"></td>
                   <td th:text="${product.hide}"></td>
                   <!-- <div sec:authorize="hasAnyAuthority('EDITOR', 'ADMIN')"> -->
                       <td>
                           <a th:href="@{'/admin/products/edit/' + ${product.id}}">Edit</a>
                           &nbsp;&nbsp;&nbsp;&nbsp;
                           <!-- <div sec:authorize="hasAuthority('ADMIN')"> -->
                               <a th:href="@{'/admin/products/delete/' + ${product.id}}" 
                                  onclick="return confirm('Are you sure you want to delete this product?')">Delete</a>
                           <!-- </div> -->
                       </td>
               </tr>
           </tbody>
       </table>
	
	    <form>
	        Page size: 
	        <select name="size" id="size" onchange="this.form.submit()">
	            <option th:selected="${productPage.size == 3}" value="3">3</option>
	            <option th:selected="${productPage.size == 5}" value="5">5</option>
	            <option th:selected="${productPage.size == 10}" value="10">10</option>
	            <option th:selected="${productPage.size == 15}" value="15">15</option>
	            <option th:selected="${productPage.size == 20}" value="20">20</option>
	        </select>
	    </form>
	
	    <div th:if="${productPage.totalPages > 0}">
	        <ul>
	            <li th:each="pageNumber : ${pageNumbers}" 
	                th:class="${pageNumber == productPage.number + 1} ? 'page-item active' : 'page-item'">
	                <a th:href="@{'/admin/products/searchpaginated?name='+${name}+'&size='+ ${productPage.size}+'&page='+${pageNumber}}"
	                   th:text="${pageNumber}"></a>
	            </li>
	        </ul>
	    </div>
	
	</div>
</body>
</html>
